<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ISP Connect</title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
		type="text/css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
	<link href="assets/css/style.css" rel="stylesheet" type="text/css">
</head>

<body>

	<!-- Header Start -->
	<header class="bg-dark text-light">
		<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
			<div class="container">
				<a href="" class="navbar-brand">
					<img src="assets/img/logo.png" class="logo" alt="ISP Connect Logo">
				</a>
				<button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarNav"
					aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle Navigation"><span
						class="navbar-toggler-icon"></span></button>
				<div class="collapse navbar-collapse" id="navbarNav">
					<ul class="navbar-nav ms-auto">
						<li class="nav-item">
							<a href="index.html" class="nav-link">Home</a>
						</li>
						<li class="nav-item">
							<a href="all-isp.html" class="nav-link">All ISP</a>
						</li>
						<li class="nav-item">
							<a href="about.html" class="nav-link">About</a>
						</li>
						<li class="nav-item">
							<a href="contact.html" class="nav-link">Contact</a>
						</li>
						<li class="nav-item">
							<a href="login.html" class="nav-link">Login</a>
						</li>
						<li class="nav-item">
							<a href="register.html" class="nav-link">Register</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>
	</header>
	<!-- Header End -->

	<!-- ISP Details Section -->
	<section class="isp-details-section py-4">
		<div class="container">
			<div class="row">
				<div class="col-md-4">
					<img id="ispPhoto" src="assets/img/company.jpg" alt="ISP Company" class="img-fluid">
				</div>
				<div class="col-md-8">
					<h2 id="ispName">ISP Company Name</h2>
					<p id="ispSlogan" class="lead">High Speed internet starting at $50/month.</p>
					<p id="ispDescription">Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
					<ul id="ispDetailsList" class="list-unstyled details-list">
						<!-- Details (e.g., Available Speeds, Support, etc.) will be dynamically injected -->
					</ul>
					<div>
						<button class="btn btn-success bookAppointmentButton" data-bs-toggle="modal"
							data-bs-target="#appointmentModal">
							<i class="fa-solid fa-calendar-check"></i> Book Appointment
						</button>
						<a id="ispContactButton" href="mailto:" class="btn btn-primary">
							<i class="fa-solid fa-envelope"></i> Contact ISP
						</a>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- More Details Start -->
	<section class="more-isp-details-section">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<h3>More Information</h3>
					<div class="promotions mt-3">
						<h4>Current Promotions</h4>
						<ul id="promotionsList">
							<!-- Promotions will be dynamically injected -->
						</ul>
					</div>
					<div class="pricing">
						<h4>Pricing Plan</h4>
						<table class="table table-bordered">
							<thead>
								<tr>
									<th>Plan</th>
									<th>Speed</th>
									<th>Price per month</th>
									<th>Features</th>
								</tr>
							</thead>
							<tbody id="pricingTable">
								<!-- Pricing plans will be dynamically injected -->
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- More Details End -->

	<!-- Customer Review Start -->
	<section class="cutomer-review-section">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<h3 class="mb-3">Customer Reviews</h3>
					<div class="media mb-2">
						<img src="assets/img/male.png" alt="Profile Picture" class="rounded-circle">
						<div class="media-body">
							<h5>Jhon Doe</h5>
							<div class="mb-2">
								<i class="fa-solid fa-star text-warning"></i>
								<i class="fa-solid fa-star text-warning"></i>
								<i class="fa-solid fa-star text-warning"></i>
								<i class="fa-solid fa-star text-warning"></i>
								<i class="fa-regular fa-star text-warning"></i>
							</div>
							<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
								tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
								quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
								consequat.</p>
						</div>
					</div>

					<div class="media mb-2">
						<img src="assets/img/female.png" alt="Profile Picture" class="rounded-circle">
						<div class="media-body">
							<h5>Alice Jhonson</h5>
							<div class="mb-2">
								<i class="fa-solid fa-star text-warning"></i>
								<i class="fa-solid fa-star text-warning"></i>
								<i class="fa-solid fa-star text-warning"></i>
								<i class="fa-solid fa-star text-warning"></i>
								<i class="fa-regular fa-star"></i>
							</div>
							<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
								tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
								quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
								consequat.</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- Customer Review End -->

	<!-- Appointment Booking Modal Start -->
	<div class="modal fade" id="appointmentModal" tabindex="-1" role="dialog" aria-labelledby="appointmentModalLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="appointmentModalLabel">Book An Appointment</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<form action="" method="" enctype="multipart/form-data" id="appointmentForm">
						<div class="form-group mb-3">
							<label for="name">Name</label>
							<input type="text" name="name" id="name" class="form-control" placeholder="Enter Your Name"
								required />
						</div>
						<div class="form-group mb-3">
							<label for="email">Email</label>
							<input type="email" name="email" id="email" class="form-control"
								placeholder="Enter Your Email" required />
						</div>
						<div class="form-group mb-3">
							<label for="phone">Phone Number</label>
							<input type="text" name="phone" id="phone" class="form-control"
								placeholder="Enter Your Phone Number" required />
						</div>
						<div class="form-group mb-3">
							<label for="address">Address</label>
							<textarea name="address" id="address" class="form-control" rows="3"
								placeholder="Enter Your Address" required></textarea>
						</div>
						<div class="form-group mb-3">
							<label for="appointmentDate">Appointment Date</label>
							<input type="date" name="appointmentDate" id="appointmentDate" class="form-control"
								required />
						</div>
						<div class="form-group mb-3">
							<label for="fileUpload">Payment Screenshot</label>
							<input type="file" name="fileUpload" id="fileUpload" class="form-control" accept="image/*"
								onchange="previewImage(event)" required />
							<img id="imagePreview">
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					<button type="submit" class="btn btn-primary" form="appointmentForm">Submit</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Appointment Booking Modal End -->

	<!-- Footer Start -->
	<footer class="bg-dark text-light py-3">
		<div class="container text-center">
			<p>&copy; 2024 ISP Connect. All Rights Reserved.</p>
			<ul class="list-inline">
				<li class="list-inline-item">
					<a href="">Privacy Policy</a>
				</li>
				<li class="list-inline-item">
					<a href="">Terms and Conditions</a>
				</li>
			</ul>
		</div>
	</footer>
	<!-- Footer End -->

	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="assets/js/script.js"></script>
	<script>
		$(document).ready(function () {
			// Function to get query parameters from URL
			function getQueryParam(param) {
				const urlParams = new URLSearchParams(window.location.search);
				return urlParams.get(param);
			}

			const ispId = getQueryParam('isp_id'); // Get ISP ID from URL

			if (!ispId) {
				// Alert the user and redirect back to the referrer page
				alert('No ISP ID provided in the URL. Redirecting you back...');
				const referrer = document.referrer || 'all-isp.html'; // Default to all-isp.html if no referrer
				window.location.href = referrer;
				return; // Stop further execution
			}

			// AJAX request to fetch ISP details
			$.ajax({
				url: 'get_isp_details.php',
				method: 'POST',
				contentType: 'application/json',
				data: JSON.stringify({ isp_id: ispId }),
				success: function (response) {
					if (response.success) {
						const isp = response.data;

						// Populate ISP details
						$('#ispPhoto').attr('src', 'assets/img/isp/' + isp.isp_photo || 'assets/img/default.jpg');
						$('#ispName').text(isp.isp_name || 'ISP Name');
						$('#ispSlogan').text(
							isp.isp_slogan || 'High Speed internet starting at $50/month.'
						);
						$('#ispDescription').text(
							isp.isp_description || 'No description available for this ISP.'
						);

						// Update "Contact ISP" button
						$('#ispContactButton').attr('href', `mailto:${isp.isp_contact_email || ''}`);

						// Populate ISP details list
						const detailsList = $('#ispDetailsList');
						const details = [
							{ label: 'Available Speeds:', value: isp.isp_available_speeds || 'N/A' },
							{ label: 'Customer Support:', value: isp.isp_support_details || 'N/A' },
							{ label: 'Contract Length:', value: isp.isp_contract_length || 'N/A' },
							{ label: 'Availability:', value: isp.isp_availability || 'N/A' },
						];
						detailsList.empty();
						details.forEach((detail) => {
							detailsList.append(
								`<li><span class="details-label">${detail.label}</span> ${detail.value}</li>`
							);
						});

						// Populate Promotions
						const promotionsList = $('#promotionsList');
						promotionsList.empty();
						if (isp.promotions.length > 0) {
							isp.promotions.forEach((promotion) => {
								promotionsList.append(`<li>${promotion}</li>`);
							});
						} else {
							promotionsList.append('<li>No promotions available.</li>');
						}

						// Populate Pricing Plans
						const pricingTable = $('#pricingTable');
						pricingTable.empty();
						if (isp.plans.length > 0) {
							isp.plans.forEach((plan) => {
								pricingTable.append(`
        						<tr>
        							<td>${plan.plan_name}</td>
        							<td>${plan.plan_speed}</td>
        							<td>$${plan.plan_price_per_month}</td>
        							<td>${plan.plan_features}</td>
        						</tr>
        						`);
							});
						} else {
							pricingTable.append('<tr><td colspan="4">No pricing plans available.</td></tr>');
						}
					} else {
						alert(response.message);
					}
				},
				error: function () {
					alert('Failed to fetch ISP details. Please try again.');
				},
			});
		});
	</script>
</body>

</html>